# RuoYi-FastAPI åç«¯ Docker éƒ¨ç½²è¯´æ˜

## ğŸ“¦ å·²å®Œæˆçš„å·¥ä½œ

âœ… åˆ›å»ºäº† Dockerfile  
âœ… åˆ›å»ºäº† .dockerignore  
âœ… æ·»åŠ äº†å¥åº·æ£€æŸ¥ç«¯ç‚¹ `/dev-api/health`  
âœ… æœ¬åœ°æ„å»ºå¹¶æµ‹è¯•äº†é•œåƒ  
âœ… é•œåƒæ ‡è®°å·²å‡†å¤‡å¥½æ¨é€åˆ° Docker Hub

## ğŸš€ é•œåƒä¿¡æ¯

- **æœ¬åœ°é•œåƒ**: `ruoyi-fastapi-backend:latest` å’Œ `ruoyi-fastapi-backend:1.0.0`
- **Docker Hub é•œåƒ**: `skatef/ruoyi-fastapi-backend:latest` å’Œ `skatef/ruoyi-fastapi-backend:1.0.0`
- **é•œåƒå¤§å°**: 662MB
- **Python ç‰ˆæœ¬**: 3.10
- **æš´éœ²ç«¯å£**: 9099

## ğŸ“ ä¸‹ä¸€æ­¥æ“ä½œï¼šæ¨é€é•œåƒåˆ° Docker Hub

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æä¾›çš„è„šæœ¬ï¼ˆæ¨èï¼‰

```powershell
cd C:\work\tinker\answer\RuoYi-Vue3-FastAPI\ruoyi-fastapi-backend
.\docker-push.ps1
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤

```bash
# 1. ç™»å½• Docker Hub
docker login -u skatef

# 2. æ¨é€ latest æ ‡ç­¾
docker push skatef/ruoyi-fastapi-backend:latest

# 3. æ¨é€ 1.0.0 æ ‡ç­¾
docker push skatef/ruoyi-fastapi-backend:1.0.0
```

## ğŸ¯ ä½¿ç”¨é•œåƒ

### åœ¨å…¶ä»–æœºå™¨ä¸Šæ‹‰å–é•œåƒ

```bash
docker pull skatef/ruoyi-fastapi-backend:latest
```

### è¿è¡Œå®¹å™¨ï¼ˆéœ€è¦é…ç½®æ•°æ®åº“å’Œ Redisï¼‰

```bash
docker run -d \
  --name ruoyi-fastapi \
  -p 9099:9099 \
  -e APP_ENV=prod \
  -e DB_TYPE=mysql \
  -e DB_HOST=your-db-host \
  -e DB_PORT=3306 \
  -e DB_USERNAME=your-username \
  -e DB_PASSWORD=your-password \
  -e DB_DATABASE=ruoyi-fastapi \
  -e REDIS_HOST=your-redis-host \
  -e REDIS_PORT=6379 \
  -e REDIS_PASSWORD=your-redis-password \
  skatef/ruoyi-fastapi-backend:latest
```

### Docker Compose ç¤ºä¾‹

åˆ›å»º `docker-compose.yml` æ–‡ä»¶ï¼š

```yaml
version: '3.8'

services:
  ruoyi-fastapi:
    image: skatef/ruoyi-fastapi-backend:latest
    container_name: ruoyi-fastapi
    restart: unless-stopped
    ports:
      - '9099:9099'
    environment:
      - APP_ENV=prod
      - APP_RELOAD=false
      - DB_TYPE=mysql
      - DB_HOST=your-db-host
      - DB_PORT=3306
      - DB_USERNAME=your-username
      - DB_PASSWORD=your-password
      - DB_DATABASE=ruoyi-fastapi
      - REDIS_HOST=your-redis-host
      - REDIS_PORT=6379
      - REDIS_PASSWORD=your-redis-password
    volumes:
      - ./uploads:/app/vf_admin/upload_path
      - ./logs:/app/logs
    healthcheck:
      test:
        [
          'CMD',
          'python',
          '-c',
          "import urllib.request; urllib.request.urlopen('http://localhost:9099/dev-api/health').read()",
        ]
      interval: 30s
      timeout: 10s
      retries: 3
```

ç„¶åè¿è¡Œï¼š

```bash
docker-compose up -d
```

## ğŸ”§ ç¯å¢ƒå˜é‡è¯´æ˜

| å˜é‡å         | è¯´æ˜                          | å¿…å¡« | é»˜è®¤å€¼                     |
| -------------- | ----------------------------- | ---- | -------------------------- |
| APP_ENV        | è¿è¡Œç¯å¢ƒ                      | å¦   | dev                        |
| APP_HOST       | ç›‘å¬åœ°å€                      | å¦   | 0.0.0.0                    |
| APP_PORT       | ç›‘å¬ç«¯å£                      | å¦   | 9099                       |
| APP_RELOAD     | çƒ­é‡è½½                        | å¦   | true                       |
| DB_TYPE        | æ•°æ®åº“ç±»å‹ (mysql/postgresql) | æ˜¯   | mysql                      |
| DB_HOST        | æ•°æ®åº“åœ°å€                    | æ˜¯   | 127.0.0.1                  |
| DB_PORT        | æ•°æ®åº“ç«¯å£                    | æ˜¯   | 3306                       |
| DB_USERNAME    | æ•°æ®åº“ç”¨æˆ·å                  | æ˜¯   | root                       |
| DB_PASSWORD    | æ•°æ®åº“å¯†ç                     | æ˜¯   | -                          |
| DB_DATABASE    | æ•°æ®åº“åç§°                    | æ˜¯   | ruoyi-fastapi              |
| REDIS_HOST     | Redis åœ°å€                    | æ˜¯   | 127.0.0.1                  |
| REDIS_PORT     | Redis ç«¯å£                    | æ˜¯   | 6379                       |
| REDIS_PASSWORD | Redis å¯†ç                     | å¦   | -                          |
| JWT_SECRET_KEY | JWT å¯†é’¥                      | å¦   | é»˜è®¤å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ï¼‰ |

## ğŸ“Š å¥åº·æ£€æŸ¥

å®¹å™¨å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ£€æŸ¥å¥åº·çŠ¶æ€ï¼š

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æ£€æŸ¥å¥åº·æ£€æŸ¥ç«¯ç‚¹
curl http://localhost:9099/dev-api/health
# å“åº”: {"status":"healthy","app":"RuoYi-FastAPI"}

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs -f ruoyi-fastapi

# æŸ¥çœ‹ API æ–‡æ¡£
# æµè§ˆå™¨è®¿é—®: http://localhost:9099/dev-api/docs
```

## ğŸ” æ•…éšœæ’æŸ¥

### å®¹å™¨æ— æ³•å¯åŠ¨

1. æ£€æŸ¥æ—¥å¿—ï¼š`docker logs ruoyi-fastapi`
2. ç¡®è®¤æ•°æ®åº“å’Œ Redis è¿æ¥é…ç½®æ­£ç¡®
3. ç¡®è®¤æ•°æ®åº“å’Œ Redis æœåŠ¡å¯è®¿é—®

### è¿æ¥è¢«æ‹’ç»

- ç¡®ä¿æ•°æ®åº“å’Œ Redis å…è®¸å®¹å™¨ IP è®¿é—®
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- å¦‚æœä½¿ç”¨ Docker ç½‘ç»œï¼Œç¡®ä¿æœåŠ¡åœ¨åŒä¸€ç½‘ç»œä¸­

### ç«¯å£å†²çª

å¦‚æœ 9099 ç«¯å£è¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹æ˜ å°„ç«¯å£ï¼š

```bash
docker run -p 8099:9099 ...  # ä½¿ç”¨ 8099 è®¿é—®
```

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `Dockerfile` - Docker é•œåƒæ„å»ºæ–‡ä»¶
- `.dockerignore` - å¿½ç•¥ä¸éœ€è¦å¤åˆ¶çš„æ–‡ä»¶
- `.env.prod.example` - ç”Ÿäº§ç¯å¢ƒé…ç½®ç¤ºä¾‹
- `README.Docker.md` - Docker è¯¦ç»†æ–‡æ¡£
- `docker-push.ps1` - æ¨é€è„šæœ¬ï¼ˆWindowsï¼‰

## ğŸ‰ å®Œæˆ

ç°åœ¨æ‚¨çš„ FastAPI åç«¯å·²ç»æˆåŠŸæ‰“åŒ…æˆ Docker é•œåƒï¼æ¨é€åˆ° Docker Hub åï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨è¿™ä¸ªé•œåƒäº†ã€‚

## ğŸ“® Docker Hub åœ°å€

æ¨é€æˆåŠŸåï¼Œæ‚¨å¯ä»¥åœ¨ä»¥ä¸‹åœ°å€æŸ¥çœ‹é•œåƒï¼š

https://hub.docker.com/r/skatef/ruoyi-fastapi-backend

## ğŸ’¡ æç¤º

1. **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**ï¼šè¯·åŠ¡å¿…ä¿®æ”¹ JWT_SECRET_KEY å’Œæ•°æ®åº“å¯†ç 
2. **æ•°æ®æŒä¹…åŒ–**ï¼šå»ºè®®æŒ‚è½½ `/app/vf_admin/upload_path` å’Œ `/app/logs` ç›®å½•
3. **ç½‘ç»œé…ç½®**ï¼šå»ºè®®ä½¿ç”¨ Docker ç½‘ç»œè¿æ¥æ•°æ®åº“å’Œ Redis
4. **é•œåƒæ›´æ–°**ï¼šæ¯æ¬¡ä»£ç æ›´æ–°åé‡æ–°æ„å»ºé•œåƒå¹¶æ¨é€
